global:
  defaultStorageClass: sc-example
  kibanaEnabled: true
  elasticsearch:
    service:
      name: elasticsearch
      ports:
        restAPI: 9200

clusterDomain: cluster.local

## user name elastic
security:
  enabled: true
  tls:
    restEncryption: false
    autoGenerated: true

image:
  registry: docker.io
  repository: bitnamilegacy/elasticsearch
  tag: 9.1.2-debian-12-r0

sysctlImage:
  registry: docker.io
  repository: bitnamilegacy/os-shell
  tag: 12-debian-12-r50

extraEnvVars:
  - name: ELASTICSEARCH_HEAP_SIZE
    value: 4096m
  - name: ELASTICSEARCH_DISABLE_JVM_HEAP_DUMP
    value: "yes"
  - name: TZ
    value: Asia/Shanghai

plugins: "analysis-smartcn"

# 先使用单节点模式，后面有需求可以再扩展
master:
  masterOnly: false
  replicaCount: 1
  resources:
    requests:
      cpu: 1
      memory: 2Gi
    limits:
      cpu: 2
      memory: 10Gi
  persistence:
    size: 50Gi
data:
  replicaCount: 0
  # persistence:
  #   size: 50Gi
coordinating:
  replicaCount: 0
ingest:
  replicaCount: 0

service:
  type: ClusterIP

kibana:
  image:
    registry: docker.io
    repository: bitnamilegacy/kibana
    tag: 9.1.2-debian-12-r0

  clusterDomain: cluster.local

  auth:
    username: elastic

  elasticsearch:
    security:
      auth:
        enabled: true
        elasticsearchPasswordSecret: "elasticsearch"
        createSystemUser: true
      tls:
        enabled: false

  extraEnvVars:
    - name: TZ
      value: Asia/Shanghai

  persistence:
    annotations:
      helm.sh/resource-policy: keep
    size: 10Gi

  ingress:
    enabled: true
    hostname: es.git.example.com
    path: /
    annotations:
      helm.sh/resource-policy: keep
      nginx.ingress.kubernetes.io/whitelist-source-range: "10.0.0.0/8"
    tls: false
    extraTls:
      - hosts:
          - es.git.example.com
        secretName: gitlab-wildcard-tls
    ingressClassName: "nginx"

  resources:
    requests:
      cpu: 500m
      memory: 1Gi
    limits:
      cpu: 2
      memory: 4Gi
#
# set es replicas to zero, index health check
##############
#  PUT _index_template/no-replicas
#  {
#    "priority": 1,
#    "template": {
#      "settings": {
#        "number_of_replicas": 0,
#        "index": {}
#      }
#    },
#    "index_patterns": [
#      "*"
#    ]
#  }
##############
